{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":138},"end":{"line":7,"column":69,"index":207}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.saveIngredients = saveIngredients;\n  exports.getIngredients = getIngredients;\n  exports.removeIngredients = removeIngredients;\n  exports.clearAllIngredients = clearAllIngredients;\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[0], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  /**\n   * Ingredients Service\n   * Handles saving and retrieving user's available ingredients\n   * Auto-saves when user selects ingredients\n   */\n\n  const API_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n  const LOCAL_INGREDIENTS_KEY = 'user_ingredients_cache';\n  /**\n   * Save ingredients to the server (and local cache)\n   * @param userId User ID\n   * @param ingredients Array of ingredient names\n   * @param append If true, adds to existing. If false, replaces all.\n   */\n  async function saveIngredients(userId, ingredients, append = true) {\n    try {\n      // First save to local cache\n      if (append) {\n        const existing = await getLocalIngredients();\n        const merged = [...new Set([...existing, ...ingredients])];\n        await AsyncStorage.default.setItem(LOCAL_INGREDIENTS_KEY, JSON.stringify(merged));\n      } else {\n        await AsyncStorage.default.setItem(LOCAL_INGREDIENTS_KEY, JSON.stringify(ingredients));\n      }\n\n      // Then try to sync with server\n      const response = await fetch(`${API_URL}/api/users/${userId}/ingredients`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          userId,\n          ingredients,\n          append\n        })\n      });\n      return response.ok;\n    } catch (error) {\n      console.error('[Ingredients] Error saving:', error);\n      // Even if server fails, local save succeeded\n      return true;\n    }\n  }\n\n  /**\n   * Get ingredients from server, fallback to local cache\n   */\n  async function getIngredients(userId) {\n    try {\n      const response = await fetch(`${API_URL}/api/users/${userId}/ingredients`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      if (response.ok) {\n        const data = await response.json();\n        // Update local cache\n        await AsyncStorage.default.setItem(LOCAL_INGREDIENTS_KEY, JSON.stringify(data.ingredients));\n        return data.ingredients;\n      }\n    } catch (error) {\n      console.log('[Ingredients] Server fetch failed, using local cache');\n    }\n\n    // Fallback to local\n    return getLocalIngredients();\n  }\n\n  /**\n   * Get locally cached ingredients\n   */\n  async function getLocalIngredients() {\n    try {\n      const cached = await AsyncStorage.default.getItem(LOCAL_INGREDIENTS_KEY);\n      return cached ? JSON.parse(cached) : [];\n    } catch (error) {\n      return [];\n    }\n  }\n\n  /**\n   * Remove specific ingredients\n   */\n  async function removeIngredients(userId, ingredientsToRemove) {\n    try {\n      // Update local cache\n      const current = await getLocalIngredients();\n      const filtered = current.filter(i => !ingredientsToRemove.includes(i));\n      await AsyncStorage.default.setItem(LOCAL_INGREDIENTS_KEY, JSON.stringify(filtered));\n\n      // Sync with server\n      const response = await fetch(`${API_URL}/api/users/${userId}/ingredients`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          ingredients_to_remove: ingredientsToRemove\n        })\n      });\n      return response.ok;\n    } catch (error) {\n      console.error('[Ingredients] Error removing:', error);\n      return true; // Local update succeeded\n    }\n  }\n\n  /**\n   * Clear all ingredients\n   */\n  async function clearAllIngredients(userId) {\n    try {\n      await AsyncStorage.default.setItem(LOCAL_INGREDIENTS_KEY, JSON.stringify([]));\n      const response = await fetch(`${API_URL}/api/users/${userId}/ingredients`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      return response.ok;\n    } catch (error) {\n      console.error('[Ingredients] Error clearing:', error);\n      return true;\n    }\n  }\n});","lineCount":145,"map":[[12,2,24,0,"exports"],[12,9,24,0],[12,10,24,0,"saveIngredients"],[12,25,24,0],[12,28,24,0,"saveIngredients"],[12,43,24,0],[13,2,57,0,"exports"],[13,9,57,0],[13,10,57,0,"getIngredients"],[13,24,57,0],[13,27,57,0,"getIngredients"],[13,41,57,0],[14,2,93,0,"exports"],[14,9,93,0],[14,10,93,0,"removeIngredients"],[14,27,93,0],[14,30,93,0,"removeIngredients"],[14,47,93,0],[15,2,120,0,"exports"],[15,9,120,0],[15,10,120,0,"clearAllIngredients"],[15,29,120,0],[15,32,120,0,"clearAllIngredients"],[15,51,120,0],[16,2,7,0],[16,6,7,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,7,0],[16,45,7,0,"require"],[16,52,7,0],[16,53,7,0,"_dependencyMap"],[16,67,7,0],[17,2,7,0],[17,6,7,0,"AsyncStorage"],[17,18,7,0],[17,21,7,0,"_interopDefault"],[17,36,7,0],[17,37,7,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,7,0],[18,2,1,0],[19,0,2,0],[20,0,3,0],[21,0,4,0],[22,0,5,0],[24,2,9,0],[24,8,9,6,"API_URL"],[24,15,9,13],[24,18,9,16,"process"],[24,25,9,23],[24,26,9,24,"env"],[24,29,9,27],[24,30,9,28,"EXPO_PUBLIC_BACKEND_URL"],[24,53,9,51],[25,2,10,0],[25,8,10,6,"LOCAL_INGREDIENTS_KEY"],[25,29,10,27],[25,32,10,30],[25,56,10,54],[26,2,18,0],[27,0,19,0],[28,0,20,0],[29,0,21,0],[30,0,22,0],[31,0,23,0],[32,2,24,7],[32,17,24,22,"saveIngredients"],[32,32,24,37,"saveIngredients"],[32,33,25,2,"userId"],[32,39,25,16],[32,41,26,2,"ingredients"],[32,52,26,23],[32,54,27,2,"append"],[32,60,27,17],[32,63,27,20],[32,67,27,24],[32,69,28,20],[33,4,29,2],[33,8,29,6],[34,6,30,4],[35,6,31,4],[35,10,31,8,"append"],[35,16,31,14],[35,18,31,16],[36,8,32,6],[36,14,32,12,"existing"],[36,22,32,20],[36,25,32,23],[36,31,32,29,"getLocalIngredients"],[36,50,32,48],[36,51,32,49],[36,52,32,50],[37,8,33,6],[37,14,33,12,"merged"],[37,20,33,18],[37,23,33,21],[37,24,33,22],[37,27,33,25],[37,31,33,29,"Set"],[37,34,33,32],[37,35,33,33],[37,36,33,34],[37,39,33,37,"existing"],[37,47,33,45],[37,49,33,47],[37,52,33,50,"ingredients"],[37,63,33,61],[37,64,33,62],[37,65,33,63],[37,66,33,64],[38,8,34,6],[38,14,34,12,"AsyncStorage"],[38,26,34,24],[38,27,34,24,"default"],[38,34,34,24],[38,35,34,25,"setItem"],[38,42,34,32],[38,43,34,33,"LOCAL_INGREDIENTS_KEY"],[38,64,34,54],[38,66,34,56,"JSON"],[38,70,34,60],[38,71,34,61,"stringify"],[38,80,34,70],[38,81,34,71,"merged"],[38,87,34,77],[38,88,34,78],[38,89,34,79],[39,6,35,4],[39,7,35,5],[39,13,35,11],[40,8,36,6],[40,14,36,12,"AsyncStorage"],[40,26,36,24],[40,27,36,24,"default"],[40,34,36,24],[40,35,36,25,"setItem"],[40,42,36,32],[40,43,36,33,"LOCAL_INGREDIENTS_KEY"],[40,64,36,54],[40,66,36,56,"JSON"],[40,70,36,60],[40,71,36,61,"stringify"],[40,80,36,70],[40,81,36,71,"ingredients"],[40,92,36,82],[40,93,36,83],[40,94,36,84],[41,6,37,4],[43,6,39,4],[44,6,40,4],[44,12,40,10,"response"],[44,20,40,18],[44,23,40,21],[44,29,40,27,"fetch"],[44,34,40,32],[44,35,40,33],[44,38,40,36,"API_URL"],[44,45,40,43],[44,59,40,57,"userId"],[44,65,40,63],[44,79,40,77],[44,81,40,79],[45,8,41,6,"method"],[45,14,41,12],[45,16,41,14],[45,22,41,20],[46,8,42,6,"headers"],[46,15,42,13],[46,17,42,15],[47,10,42,17],[47,24,42,31],[47,26,42,33],[48,8,42,52],[48,9,42,53],[49,8,43,6,"body"],[49,12,43,10],[49,14,43,12,"JSON"],[49,18,43,16],[49,19,43,17,"stringify"],[49,28,43,26],[49,29,43,27],[50,10,43,29,"userId"],[50,16,43,35],[51,10,43,37,"ingredients"],[51,21,43,48],[52,10,43,50,"append"],[53,8,43,57],[53,9,43,58],[54,6,44,4],[54,7,44,5],[54,8,44,6],[55,6,46,4],[55,13,46,11,"response"],[55,21,46,19],[55,22,46,20,"ok"],[55,24,46,22],[56,4,47,2],[56,5,47,3],[56,6,47,4],[56,13,47,11,"error"],[56,18,47,16],[56,20,47,18],[57,6,48,4,"console"],[57,13,48,11],[57,14,48,12,"error"],[57,19,48,17],[57,20,48,18],[57,49,48,47],[57,51,48,49,"error"],[57,56,48,54],[57,57,48,55],[58,6,49,4],[59,6,50,4],[59,13,50,11],[59,17,50,15],[60,4,51,2],[61,2,52,0],[63,2,54,0],[64,0,55,0],[65,0,56,0],[66,2,57,7],[66,17,57,22,"getIngredients"],[66,31,57,36,"getIngredients"],[66,32,57,37,"userId"],[66,38,57,51],[66,40,57,72],[67,4,58,2],[67,8,58,6],[68,6,59,4],[68,12,59,10,"response"],[68,20,59,18],[68,23,59,21],[68,29,59,27,"fetch"],[68,34,59,32],[68,35,59,33],[68,38,59,36,"API_URL"],[68,45,59,43],[68,59,59,57,"userId"],[68,65,59,63],[68,79,59,77],[68,81,59,79],[69,8,60,6,"method"],[69,14,60,12],[69,16,60,14],[69,21,60,19],[70,8,61,6,"headers"],[70,15,61,13],[70,17,61,15],[71,10,61,17],[71,24,61,31],[71,26,61,33],[72,8,61,52],[73,6,62,4],[73,7,62,5],[73,8,62,6],[74,6,64,4],[74,10,64,8,"response"],[74,18,64,16],[74,19,64,17,"ok"],[74,21,64,19],[74,23,64,21],[75,8,65,6],[75,14,65,12,"data"],[75,18,65,37],[75,21,65,40],[75,27,65,46,"response"],[75,35,65,54],[75,36,65,55,"json"],[75,40,65,59],[75,41,65,60],[75,42,65,61],[76,8,66,6],[77,8,67,6],[77,14,67,12,"AsyncStorage"],[77,26,67,24],[77,27,67,24,"default"],[77,34,67,24],[77,35,67,25,"setItem"],[77,42,67,32],[77,43,67,33,"LOCAL_INGREDIENTS_KEY"],[77,64,67,54],[77,66,67,56,"JSON"],[77,70,67,60],[77,71,67,61,"stringify"],[77,80,67,70],[77,81,67,71,"data"],[77,85,67,75],[77,86,67,76,"ingredients"],[77,97,67,87],[77,98,67,88],[77,99,67,89],[78,8,68,6],[78,15,68,13,"data"],[78,19,68,17],[78,20,68,18,"ingredients"],[78,31,68,29],[79,6,69,4],[80,4,70,2],[80,5,70,3],[80,6,70,4],[80,13,70,11,"error"],[80,18,70,16],[80,20,70,18],[81,6,71,4,"console"],[81,13,71,11],[81,14,71,12,"log"],[81,17,71,15],[81,18,71,16],[81,72,71,70],[81,73,71,71],[82,4,72,2],[84,4,74,2],[85,4,75,2],[85,11,75,9,"getLocalIngredients"],[85,30,75,28],[85,31,75,29],[85,32,75,30],[86,2,76,0],[88,2,78,0],[89,0,79,0],[90,0,80,0],[91,2,81,0],[91,17,81,15,"getLocalIngredients"],[91,36,81,34,"getLocalIngredients"],[91,37,81,34],[91,39,81,56],[92,4,82,2],[92,8,82,6],[93,6,83,4],[93,12,83,10,"cached"],[93,18,83,16],[93,21,83,19],[93,27,83,25,"AsyncStorage"],[93,39,83,37],[93,40,83,37,"default"],[93,47,83,37],[93,48,83,38,"getItem"],[93,55,83,45],[93,56,83,46,"LOCAL_INGREDIENTS_KEY"],[93,77,83,67],[93,78,83,68],[94,6,84,4],[94,13,84,11,"cached"],[94,19,84,17],[94,22,84,20,"JSON"],[94,26,84,24],[94,27,84,25,"parse"],[94,32,84,30],[94,33,84,31,"cached"],[94,39,84,37],[94,40,84,38],[94,43,84,41],[94,45,84,43],[95,4,85,2],[95,5,85,3],[95,6,85,4],[95,13,85,11,"error"],[95,18,85,16],[95,20,85,18],[96,6,86,4],[96,13,86,11],[96,15,86,13],[97,4,87,2],[98,2,88,0],[100,2,90,0],[101,0,91,0],[102,0,92,0],[103,2,93,7],[103,17,93,22,"removeIngredients"],[103,34,93,39,"removeIngredients"],[103,35,94,2,"userId"],[103,41,94,16],[103,43,95,2,"ingredientsToRemove"],[103,62,95,31],[103,64,96,20],[104,4,97,2],[104,8,97,6],[105,6,98,4],[106,6,99,4],[106,12,99,10,"current"],[106,19,99,17],[106,22,99,20],[106,28,99,26,"getLocalIngredients"],[106,47,99,45],[106,48,99,46],[106,49,99,47],[107,6,100,4],[107,12,100,10,"filtered"],[107,20,100,18],[107,23,100,21,"current"],[107,30,100,28],[107,31,100,29,"filter"],[107,37,100,35],[107,38,100,36,"i"],[107,39,100,37],[107,43,100,41],[107,44,100,42,"ingredientsToRemove"],[107,63,100,61],[107,64,100,62,"includes"],[107,72,100,70],[107,73,100,71,"i"],[107,74,100,72],[107,75,100,73],[107,76,100,74],[108,6,101,4],[108,12,101,10,"AsyncStorage"],[108,24,101,22],[108,25,101,22,"default"],[108,32,101,22],[108,33,101,23,"setItem"],[108,40,101,30],[108,41,101,31,"LOCAL_INGREDIENTS_KEY"],[108,62,101,52],[108,64,101,54,"JSON"],[108,68,101,58],[108,69,101,59,"stringify"],[108,78,101,68],[108,79,101,69,"filtered"],[108,87,101,77],[108,88,101,78],[108,89,101,79],[110,6,103,4],[111,6,104,4],[111,12,104,10,"response"],[111,20,104,18],[111,23,104,21],[111,29,104,27,"fetch"],[111,34,104,32],[111,35,104,33],[111,38,104,36,"API_URL"],[111,45,104,43],[111,59,104,57,"userId"],[111,65,104,63],[111,79,104,77],[111,81,104,79],[112,8,105,6,"method"],[112,14,105,12],[112,16,105,14],[112,24,105,22],[113,8,106,6,"headers"],[113,15,106,13],[113,17,106,15],[114,10,106,17],[114,24,106,31],[114,26,106,33],[115,8,106,52],[115,9,106,53],[116,8,107,6,"body"],[116,12,107,10],[116,14,107,12,"JSON"],[116,18,107,16],[116,19,107,17,"stringify"],[116,28,107,26],[116,29,107,27],[117,10,107,29,"ingredients_to_remove"],[117,31,107,50],[117,33,107,52,"ingredientsToRemove"],[118,8,107,72],[118,9,107,73],[119,6,108,4],[119,7,108,5],[119,8,108,6],[120,6,110,4],[120,13,110,11,"response"],[120,21,110,19],[120,22,110,20,"ok"],[120,24,110,22],[121,4,111,2],[121,5,111,3],[121,6,111,4],[121,13,111,11,"error"],[121,18,111,16],[121,20,111,18],[122,6,112,4,"console"],[122,13,112,11],[122,14,112,12,"error"],[122,19,112,17],[122,20,112,18],[122,51,112,49],[122,53,112,51,"error"],[122,58,112,56],[122,59,112,57],[123,6,113,4],[123,13,113,11],[123,17,113,15],[123,18,113,16],[123,19,113,17],[124,4,114,2],[125,2,115,0],[127,2,117,0],[128,0,118,0],[129,0,119,0],[130,2,120,7],[130,17,120,22,"clearAllIngredients"],[130,36,120,41,"clearAllIngredients"],[130,37,120,42,"userId"],[130,43,120,56],[130,45,120,76],[131,4,121,2],[131,8,121,6],[132,6,122,4],[132,12,122,10,"AsyncStorage"],[132,24,122,22],[132,25,122,22,"default"],[132,32,122,22],[132,33,122,23,"setItem"],[132,40,122,30],[132,41,122,31,"LOCAL_INGREDIENTS_KEY"],[132,62,122,52],[132,64,122,54,"JSON"],[132,68,122,58],[132,69,122,59,"stringify"],[132,78,122,68],[132,79,122,69],[132,81,122,71],[132,82,122,72],[132,83,122,73],[133,6,124,4],[133,12,124,10,"response"],[133,20,124,18],[133,23,124,21],[133,29,124,27,"fetch"],[133,34,124,32],[133,35,124,33],[133,38,124,36,"API_URL"],[133,45,124,43],[133,59,124,57,"userId"],[133,65,124,63],[133,79,124,77],[133,81,124,79],[134,8,125,6,"method"],[134,14,125,12],[134,16,125,14],[134,24,125,22],[135,8,126,6,"headers"],[135,15,126,13],[135,17,126,15],[136,10,126,17],[136,24,126,31],[136,26,126,33],[137,8,126,52],[138,6,127,4],[138,7,127,5],[138,8,127,6],[139,6,129,4],[139,13,129,11,"response"],[139,21,129,19],[139,22,129,20,"ok"],[139,24,129,22],[140,4,130,2],[140,5,130,3],[140,6,130,4],[140,13,130,11,"error"],[140,18,130,16],[140,20,130,18],[141,6,131,4,"console"],[141,13,131,11],[141,14,131,12,"error"],[141,19,131,17],[141,20,131,18],[141,51,131,49],[141,53,131,51,"error"],[141,58,131,56],[141,59,131,57],[142,6,132,4],[142,13,132,11],[142,17,132,15],[143,4,133,2],[144,2,134,0],[145,0,134,1],[145,3]],"functionMap":{"names":["<global>","saveIngredients","getIngredients","getLocalIngredients","removeIngredients","current.filter$argument_0","clearAllIngredients"],"mappings":"AAA;OCuB;CD4B;OEK;CFmB;AGK;CHO;OIK;oCCO,qCD;CJe;OMK;CNc"},"hasCjsExports":false},"type":"js/module"}]}