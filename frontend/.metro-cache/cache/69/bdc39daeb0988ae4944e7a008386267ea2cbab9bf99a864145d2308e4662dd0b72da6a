{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":138},"end":{"line":7,"column":69,"index":207}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.saveIngredients = saveIngredients;\n  exports.getIngredients = getIngredients;\n  exports.removeIngredients = removeIngredients;\n  exports.clearAllIngredients = clearAllIngredients;\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  /**\n   * Ingredients Service\n   * Handles saving and retrieving user's available ingredients\n   * Auto-saves when user selects ingredients\n   */\n\n  const API_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL;\n  const LOCAL_INGREDIENTS_KEY = 'user_ingredients_cache';\n  /**\n   * Save ingredients to the server (and local cache)\n   * @param userId User ID\n   * @param ingredients Array of ingredient names\n   * @param append If true, adds to existing. If false, replaces all.\n   */\n  async function saveIngredients(userId, ingredients, append = true) {\n    try {\n      // First save to local cache\n      if (append) {\n        const existing = await getLocalIngredients();\n        const merged = [...new Set([...existing, ...ingredients])];\n        await AsyncStorage.default.setItem(LOCAL_INGREDIENTS_KEY, JSON.stringify(merged));\n      } else {\n        await AsyncStorage.default.setItem(LOCAL_INGREDIENTS_KEY, JSON.stringify(ingredients));\n      }\n\n      // Then try to sync with server\n      const response = await fetch(`${API_URL}/api/users/${userId}/ingredients`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          userId,\n          ingredients,\n          append\n        })\n      });\n      return response.ok;\n    } catch (error) {\n      console.error('[Ingredients] Error saving:', error);\n      // Even if server fails, local save succeeded\n      return true;\n    }\n  }\n\n  /**\n   * Get ingredients from server, fallback to local cache\n   */\n  async function getIngredients(userId) {\n    try {\n      const response = await fetch(`${API_URL}/api/users/${userId}/ingredients`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      if (response.ok) {\n        const data = await response.json();\n        // Update local cache\n        await AsyncStorage.default.setItem(LOCAL_INGREDIENTS_KEY, JSON.stringify(data.ingredients));\n        return data.ingredients;\n      }\n    } catch (error) {\n      console.log('[Ingredients] Server fetch failed, using local cache');\n    }\n\n    // Fallback to local\n    return getLocalIngredients();\n  }\n\n  /**\n   * Get locally cached ingredients\n   */\n  async function getLocalIngredients() {\n    try {\n      const cached = await AsyncStorage.default.getItem(LOCAL_INGREDIENTS_KEY);\n      return cached ? JSON.parse(cached) : [];\n    } catch (error) {\n      return [];\n    }\n  }\n\n  /**\n   * Remove specific ingredients\n   */\n  async function removeIngredients(userId, ingredientsToRemove) {\n    try {\n      // Update local cache\n      const current = await getLocalIngredients();\n      const filtered = current.filter(i => !ingredientsToRemove.includes(i));\n      await AsyncStorage.default.setItem(LOCAL_INGREDIENTS_KEY, JSON.stringify(filtered));\n\n      // Sync with server\n      const response = await fetch(`${API_URL}/api/users/${userId}/ingredients`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          ingredients_to_remove: ingredientsToRemove\n        })\n      });\n      return response.ok;\n    } catch (error) {\n      console.error('[Ingredients] Error removing:', error);\n      return true; // Local update succeeded\n    }\n  }\n\n  /**\n   * Clear all ingredients\n   */\n  async function clearAllIngredients(userId) {\n    try {\n      await AsyncStorage.default.setItem(LOCAL_INGREDIENTS_KEY, JSON.stringify([]));\n      const response = await fetch(`${API_URL}/api/users/${userId}/ingredients`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      return response.ok;\n    } catch (error) {\n      console.error('[Ingredients] Error clearing:', error);\n      return true;\n    }\n  }\n});","lineCount":146,"map":[[12,2,24,0,"exports"],[12,9,24,0],[12,10,24,0,"saveIngredients"],[12,25,24,0],[12,28,24,0,"saveIngredients"],[12,43,24,0],[13,2,57,0,"exports"],[13,9,57,0],[13,10,57,0,"getIngredients"],[13,24,57,0],[13,27,57,0,"getIngredients"],[13,41,57,0],[14,2,93,0,"exports"],[14,9,93,0],[14,10,93,0,"removeIngredients"],[14,27,93,0],[14,30,93,0,"removeIngredients"],[14,47,93,0],[15,2,120,0,"exports"],[15,9,120,0],[15,10,120,0,"clearAllIngredients"],[15,29,120,0],[15,32,120,0,"clearAllIngredients"],[15,51,120,0],[16,2,134,1],[16,6,134,1,"_expoVirtualEnv"],[16,21,134,1],[16,24,134,1,"require"],[16,31,134,1],[16,32,134,1,"_dependencyMap"],[16,46,134,1],[17,2,7,0],[17,6,7,0,"_reactNativeAsyncStorageAsyncStorage"],[17,42,7,0],[17,45,7,0,"require"],[17,52,7,0],[17,53,7,0,"_dependencyMap"],[17,67,7,0],[18,2,7,0],[18,6,7,0,"AsyncStorage"],[18,18,7,0],[18,21,7,0,"_interopDefault"],[18,36,7,0],[18,37,7,0,"_reactNativeAsyncStorageAsyncStorage"],[18,73,7,0],[19,2,1,0],[20,0,2,0],[21,0,3,0],[22,0,4,0],[23,0,5,0],[25,2,9,0],[25,8,9,6,"API_URL"],[25,15,9,13],[25,18,9,13,"_expoVirtualEnv"],[25,33,9,13],[25,34,9,13,"env"],[25,37,9,13],[25,38,9,13,"EXPO_PUBLIC_BACKEND_URL"],[25,61,9,51],[26,2,10,0],[26,8,10,6,"LOCAL_INGREDIENTS_KEY"],[26,29,10,27],[26,32,10,30],[26,56,10,54],[27,2,18,0],[28,0,19,0],[29,0,20,0],[30,0,21,0],[31,0,22,0],[32,0,23,0],[33,2,24,7],[33,17,24,22,"saveIngredients"],[33,32,24,37,"saveIngredients"],[33,33,25,2,"userId"],[33,39,25,16],[33,41,26,2,"ingredients"],[33,52,26,23],[33,54,27,2,"append"],[33,60,27,17],[33,63,27,20],[33,67,27,24],[33,69,28,20],[34,4,29,2],[34,8,29,6],[35,6,30,4],[36,6,31,4],[36,10,31,8,"append"],[36,16,31,14],[36,18,31,16],[37,8,32,6],[37,14,32,12,"existing"],[37,22,32,20],[37,25,32,23],[37,31,32,29,"getLocalIngredients"],[37,50,32,48],[37,51,32,49],[37,52,32,50],[38,8,33,6],[38,14,33,12,"merged"],[38,20,33,18],[38,23,33,21],[38,24,33,22],[38,27,33,25],[38,31,33,29,"Set"],[38,34,33,32],[38,35,33,33],[38,36,33,34],[38,39,33,37,"existing"],[38,47,33,45],[38,49,33,47],[38,52,33,50,"ingredients"],[38,63,33,61],[38,64,33,62],[38,65,33,63],[38,66,33,64],[39,8,34,6],[39,14,34,12,"AsyncStorage"],[39,26,34,24],[39,27,34,24,"default"],[39,34,34,24],[39,35,34,25,"setItem"],[39,42,34,32],[39,43,34,33,"LOCAL_INGREDIENTS_KEY"],[39,64,34,54],[39,66,34,56,"JSON"],[39,70,34,60],[39,71,34,61,"stringify"],[39,80,34,70],[39,81,34,71,"merged"],[39,87,34,77],[39,88,34,78],[39,89,34,79],[40,6,35,4],[40,7,35,5],[40,13,35,11],[41,8,36,6],[41,14,36,12,"AsyncStorage"],[41,26,36,24],[41,27,36,24,"default"],[41,34,36,24],[41,35,36,25,"setItem"],[41,42,36,32],[41,43,36,33,"LOCAL_INGREDIENTS_KEY"],[41,64,36,54],[41,66,36,56,"JSON"],[41,70,36,60],[41,71,36,61,"stringify"],[41,80,36,70],[41,81,36,71,"ingredients"],[41,92,36,82],[41,93,36,83],[41,94,36,84],[42,6,37,4],[44,6,39,4],[45,6,40,4],[45,12,40,10,"response"],[45,20,40,18],[45,23,40,21],[45,29,40,27,"fetch"],[45,34,40,32],[45,35,40,33],[45,38,40,36,"API_URL"],[45,45,40,43],[45,59,40,57,"userId"],[45,65,40,63],[45,79,40,77],[45,81,40,79],[46,8,41,6,"method"],[46,14,41,12],[46,16,41,14],[46,22,41,20],[47,8,42,6,"headers"],[47,15,42,13],[47,17,42,15],[48,10,42,17],[48,24,42,31],[48,26,42,33],[49,8,42,52],[49,9,42,53],[50,8,43,6,"body"],[50,12,43,10],[50,14,43,12,"JSON"],[50,18,43,16],[50,19,43,17,"stringify"],[50,28,43,26],[50,29,43,27],[51,10,43,29,"userId"],[51,16,43,35],[52,10,43,37,"ingredients"],[52,21,43,48],[53,10,43,50,"append"],[54,8,43,57],[54,9,43,58],[55,6,44,4],[55,7,44,5],[55,8,44,6],[56,6,46,4],[56,13,46,11,"response"],[56,21,46,19],[56,22,46,20,"ok"],[56,24,46,22],[57,4,47,2],[57,5,47,3],[57,6,47,4],[57,13,47,11,"error"],[57,18,47,16],[57,20,47,18],[58,6,48,4,"console"],[58,13,48,11],[58,14,48,12,"error"],[58,19,48,17],[58,20,48,18],[58,49,48,47],[58,51,48,49,"error"],[58,56,48,54],[58,57,48,55],[59,6,49,4],[60,6,50,4],[60,13,50,11],[60,17,50,15],[61,4,51,2],[62,2,52,0],[64,2,54,0],[65,0,55,0],[66,0,56,0],[67,2,57,7],[67,17,57,22,"getIngredients"],[67,31,57,36,"getIngredients"],[67,32,57,37,"userId"],[67,38,57,51],[67,40,57,72],[68,4,58,2],[68,8,58,6],[69,6,59,4],[69,12,59,10,"response"],[69,20,59,18],[69,23,59,21],[69,29,59,27,"fetch"],[69,34,59,32],[69,35,59,33],[69,38,59,36,"API_URL"],[69,45,59,43],[69,59,59,57,"userId"],[69,65,59,63],[69,79,59,77],[69,81,59,79],[70,8,60,6,"method"],[70,14,60,12],[70,16,60,14],[70,21,60,19],[71,8,61,6,"headers"],[71,15,61,13],[71,17,61,15],[72,10,61,17],[72,24,61,31],[72,26,61,33],[73,8,61,52],[74,6,62,4],[74,7,62,5],[74,8,62,6],[75,6,64,4],[75,10,64,8,"response"],[75,18,64,16],[75,19,64,17,"ok"],[75,21,64,19],[75,23,64,21],[76,8,65,6],[76,14,65,12,"data"],[76,18,65,37],[76,21,65,40],[76,27,65,46,"response"],[76,35,65,54],[76,36,65,55,"json"],[76,40,65,59],[76,41,65,60],[76,42,65,61],[77,8,66,6],[78,8,67,6],[78,14,67,12,"AsyncStorage"],[78,26,67,24],[78,27,67,24,"default"],[78,34,67,24],[78,35,67,25,"setItem"],[78,42,67,32],[78,43,67,33,"LOCAL_INGREDIENTS_KEY"],[78,64,67,54],[78,66,67,56,"JSON"],[78,70,67,60],[78,71,67,61,"stringify"],[78,80,67,70],[78,81,67,71,"data"],[78,85,67,75],[78,86,67,76,"ingredients"],[78,97,67,87],[78,98,67,88],[78,99,67,89],[79,8,68,6],[79,15,68,13,"data"],[79,19,68,17],[79,20,68,18,"ingredients"],[79,31,68,29],[80,6,69,4],[81,4,70,2],[81,5,70,3],[81,6,70,4],[81,13,70,11,"error"],[81,18,70,16],[81,20,70,18],[82,6,71,4,"console"],[82,13,71,11],[82,14,71,12,"log"],[82,17,71,15],[82,18,71,16],[82,72,71,70],[82,73,71,71],[83,4,72,2],[85,4,74,2],[86,4,75,2],[86,11,75,9,"getLocalIngredients"],[86,30,75,28],[86,31,75,29],[86,32,75,30],[87,2,76,0],[89,2,78,0],[90,0,79,0],[91,0,80,0],[92,2,81,0],[92,17,81,15,"getLocalIngredients"],[92,36,81,34,"getLocalIngredients"],[92,37,81,34],[92,39,81,56],[93,4,82,2],[93,8,82,6],[94,6,83,4],[94,12,83,10,"cached"],[94,18,83,16],[94,21,83,19],[94,27,83,25,"AsyncStorage"],[94,39,83,37],[94,40,83,37,"default"],[94,47,83,37],[94,48,83,38,"getItem"],[94,55,83,45],[94,56,83,46,"LOCAL_INGREDIENTS_KEY"],[94,77,83,67],[94,78,83,68],[95,6,84,4],[95,13,84,11,"cached"],[95,19,84,17],[95,22,84,20,"JSON"],[95,26,84,24],[95,27,84,25,"parse"],[95,32,84,30],[95,33,84,31,"cached"],[95,39,84,37],[95,40,84,38],[95,43,84,41],[95,45,84,43],[96,4,85,2],[96,5,85,3],[96,6,85,4],[96,13,85,11,"error"],[96,18,85,16],[96,20,85,18],[97,6,86,4],[97,13,86,11],[97,15,86,13],[98,4,87,2],[99,2,88,0],[101,2,90,0],[102,0,91,0],[103,0,92,0],[104,2,93,7],[104,17,93,22,"removeIngredients"],[104,34,93,39,"removeIngredients"],[104,35,94,2,"userId"],[104,41,94,16],[104,43,95,2,"ingredientsToRemove"],[104,62,95,31],[104,64,96,20],[105,4,97,2],[105,8,97,6],[106,6,98,4],[107,6,99,4],[107,12,99,10,"current"],[107,19,99,17],[107,22,99,20],[107,28,99,26,"getLocalIngredients"],[107,47,99,45],[107,48,99,46],[107,49,99,47],[108,6,100,4],[108,12,100,10,"filtered"],[108,20,100,18],[108,23,100,21,"current"],[108,30,100,28],[108,31,100,29,"filter"],[108,37,100,35],[108,38,100,36,"i"],[108,39,100,37],[108,43,100,41],[108,44,100,42,"ingredientsToRemove"],[108,63,100,61],[108,64,100,62,"includes"],[108,72,100,70],[108,73,100,71,"i"],[108,74,100,72],[108,75,100,73],[108,76,100,74],[109,6,101,4],[109,12,101,10,"AsyncStorage"],[109,24,101,22],[109,25,101,22,"default"],[109,32,101,22],[109,33,101,23,"setItem"],[109,40,101,30],[109,41,101,31,"LOCAL_INGREDIENTS_KEY"],[109,62,101,52],[109,64,101,54,"JSON"],[109,68,101,58],[109,69,101,59,"stringify"],[109,78,101,68],[109,79,101,69,"filtered"],[109,87,101,77],[109,88,101,78],[109,89,101,79],[111,6,103,4],[112,6,104,4],[112,12,104,10,"response"],[112,20,104,18],[112,23,104,21],[112,29,104,27,"fetch"],[112,34,104,32],[112,35,104,33],[112,38,104,36,"API_URL"],[112,45,104,43],[112,59,104,57,"userId"],[112,65,104,63],[112,79,104,77],[112,81,104,79],[113,8,105,6,"method"],[113,14,105,12],[113,16,105,14],[113,24,105,22],[114,8,106,6,"headers"],[114,15,106,13],[114,17,106,15],[115,10,106,17],[115,24,106,31],[115,26,106,33],[116,8,106,52],[116,9,106,53],[117,8,107,6,"body"],[117,12,107,10],[117,14,107,12,"JSON"],[117,18,107,16],[117,19,107,17,"stringify"],[117,28,107,26],[117,29,107,27],[118,10,107,29,"ingredients_to_remove"],[118,31,107,50],[118,33,107,52,"ingredientsToRemove"],[119,8,107,72],[119,9,107,73],[120,6,108,4],[120,7,108,5],[120,8,108,6],[121,6,110,4],[121,13,110,11,"response"],[121,21,110,19],[121,22,110,20,"ok"],[121,24,110,22],[122,4,111,2],[122,5,111,3],[122,6,111,4],[122,13,111,11,"error"],[122,18,111,16],[122,20,111,18],[123,6,112,4,"console"],[123,13,112,11],[123,14,112,12,"error"],[123,19,112,17],[123,20,112,18],[123,51,112,49],[123,53,112,51,"error"],[123,58,112,56],[123,59,112,57],[124,6,113,4],[124,13,113,11],[124,17,113,15],[124,18,113,16],[124,19,113,17],[125,4,114,2],[126,2,115,0],[128,2,117,0],[129,0,118,0],[130,0,119,0],[131,2,120,7],[131,17,120,22,"clearAllIngredients"],[131,36,120,41,"clearAllIngredients"],[131,37,120,42,"userId"],[131,43,120,56],[131,45,120,76],[132,4,121,2],[132,8,121,6],[133,6,122,4],[133,12,122,10,"AsyncStorage"],[133,24,122,22],[133,25,122,22,"default"],[133,32,122,22],[133,33,122,23,"setItem"],[133,40,122,30],[133,41,122,31,"LOCAL_INGREDIENTS_KEY"],[133,62,122,52],[133,64,122,54,"JSON"],[133,68,122,58],[133,69,122,59,"stringify"],[133,78,122,68],[133,79,122,69],[133,81,122,71],[133,82,122,72],[133,83,122,73],[134,6,124,4],[134,12,124,10,"response"],[134,20,124,18],[134,23,124,21],[134,29,124,27,"fetch"],[134,34,124,32],[134,35,124,33],[134,38,124,36,"API_URL"],[134,45,124,43],[134,59,124,57,"userId"],[134,65,124,63],[134,79,124,77],[134,81,124,79],[135,8,125,6,"method"],[135,14,125,12],[135,16,125,14],[135,24,125,22],[136,8,126,6,"headers"],[136,15,126,13],[136,17,126,15],[137,10,126,17],[137,24,126,31],[137,26,126,33],[138,8,126,52],[139,6,127,4],[139,7,127,5],[139,8,127,6],[140,6,129,4],[140,13,129,11,"response"],[140,21,129,19],[140,22,129,20,"ok"],[140,24,129,22],[141,4,130,2],[141,5,130,3],[141,6,130,4],[141,13,130,11,"error"],[141,18,130,16],[141,20,130,18],[142,6,131,4,"console"],[142,13,131,11],[142,14,131,12,"error"],[142,19,131,17],[142,20,131,18],[142,51,131,49],[142,53,131,51,"error"],[142,58,131,56],[142,59,131,57],[143,6,132,4],[143,13,132,11],[143,17,132,15],[144,4,133,2],[145,2,134,0],[146,0,134,1],[146,3]],"functionMap":{"names":["<global>","saveIngredients","getIngredients","getLocalIngredients","removeIngredients","current.filter$argument_0","clearAllIngredients"],"mappings":"AAA;OCuB;CD4B;OEK;CFmB;AGK;CHO;OIK;oCCO,qCD;CJe;OMK;CNc"},"hasCjsExports":false},"type":"js/module"}]}